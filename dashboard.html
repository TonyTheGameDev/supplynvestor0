<!DOCTYPE html>
<html lang="en">
<head>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="icon" type="image/png" href="logo1.png">
   <link rel="stylesheet" href="dashboard.css">
   <script data-require="jquery@3.1.1" data-semver="3.1.1" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>
	

<div class="banner"> 
  <div style="text-align: center;">
   <p style="color: white; font-size: 50px;  " id="spl">0 SPL</p>
</div></div>

<div style=" overflow: hidden;">
<div class="sect" style="  float:left; background-color: rgb(29, 29, 29);">
 <p style="color:rgba(255, 255, 255, 0.411);margin: 10px;">Before shipment</p>
 <p style="font-size: 25px;margin:10px; " id="mb">0$</p>
 <p style="color: rgba(255, 255, 255, 0.411);margin: 10px;"id="splb">0SPL</p>
 
</div>
<div class="sect"style="  float:right; background-color:rgb(255, 150, 31);">
  <p style="color: rgba(255, 255, 255, 0.411);margin: 10px;">After shipment</p>
  <p  style="font-size: 25px;margin: 10px;"id="ma">0$</p>
  <p style="color: rgba(255, 255, 255, 0.411);margin:10px;"id="spla">0SPL</p>
 
</div>
</div>
<div style="margin:auto;width: 90%; background-color: rgb(31, 31, 31) ;margin-bottom: 15px ;padding: 5px; padding-left: 20px; padding-right :20px; color: white; border-radius: 5px;">
<h1>Phase 1</h1>
<p id="days_until"> You can buy supplies for n days from now.</p>
</div>
<div style="margin:auto;width: 90%; background-color: rgb(31, 31, 31) ;margin-bottom: 15px ;padding: 5px; padding-left: 20px; padding-right: 20px; color: rgba(255, 255, 255, 0.411); border-radius: 5px;">
  <h1>Phase 2</h1>
  <p> Buying supplies is no longer available. Now you wait for the supplies to be shipped to the distributors.</p><p>Wait for n days from now.</p>
  </div>
  <div style="margin:auto;width: 90%; background-color: rgb(31, 31, 31) ;margin-bottom: 15px ;padding: 5px; padding-left: 20px; padding-right: 20px; color: rgba(255, 255, 255, 0.411); border-radius: 5px;">
    <h1>Phase 3</h1>
    <p> Enjoy your profits.</p>
    </div>
    <div style="margin-top: 200px; width: 100%; height: 1px;"></div>
<div style="  width: 100%; 
right:    0;
bottom:   0;; text-align: center;position: fixed;
" >
 <div class="quantity buttons_added">
	<input type="button" value="-" class="minus"style="color: white; font-size: 20px; background-color: rgb(187, 105, 12);border: none;">
   <input type="number" step="1" min="1" max="" name="quantity" value="1" title="Qty" class="input-text qty text" size="4" pattern="" inputmode=""style="color: white; font-size:20px;background-color: rgb(255, 150, 31);border: none;" id="qty">
   <input type="button" value="+" class="plus" style="color: white; font-size: 20px; background-color: rgb(187, 105, 12); border: none;">
</div>
<!-- Load Stripe.js on your website. -->
<script src="https://js.stripe.com/v3"></script>

<!-- Create a button that your customers click to complete their purchase. Customize the styling to suit your branding. -->
<button
  style="background-color: rgb(255, 150, 31);color:#FFF;padding:8px 12px;font-size:30px;cursor:pointer;width: 100%; border: 0; height: 100px;"
  id="checkout-button-price_1MZiIyAN8BQAHpUnNYfO3krw"
  role="link"
  type="button"

>
  BUY SUPPLIES
</button>

<div id="error-message"></div>

</script>
<script>

   var quantityInput= document.getElementById('qty');


</script>
<script>

var email = localStorage.getItem("email");
(function() {
  var stripe = Stripe('pk_live_51MZh7yAN8BQAHpUnNMj4Vp5qGwKWB9ebsiJXssRwNijp9YXAEAZAR3PSiQEL33pZqkq3w1u7qCBgr2XRNSYQ95DC00iFI7hIb6');
  var checkoutButton = document.getElementById('checkout-button-price_1MZiIyAN8BQAHpUnNYfO3krw');
  checkoutButton.addEventListener('click', function () {
    /*
     * When the customer clicks on the button, redirect
     * them to Checkout.
     */  var qty= quantityInput.value;
    stripe.redirectToCheckout({
      lineItems: [{price: 'price_1MZiIyAN8BQAHpUnNYfO3krw', quantity: parseInt(qty)}],
      mode: 'payment',
      /*
       * Do not rely on the redirect to the successUrl for fulfilling
       * purchases, customers may not always reach the success_url after
       * a successful payment.
       * Instead use one of the strategies described in
       * https://stripe.com/docs/payments/checkout/fulfill-orders
       */
      successUrl: 'https://supplynvest.netlify.app/dasboard.html',
      cancelUrl: 'https://supplynvest.netlify.app/dasboard.html',
      customerEmail: email,
    })
    .then(function (result) {
      if (result.error) {
        /*
         * If `redirectToCheckout` fails due to a browser or network
         * error, display the localized error message to your customer.
         */
        var displayError = document.getElementById('error-message');
        displayError.textContent = result.error.message;
      }
    });
  });
})();
</script>


</div>


 

<script>
   function wcqib_refresh_quantity_increments() {
    jQuery("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").each(function(a, b) {
        var c = jQuery(b);
        c.addClass("buttons_added"), c.children().first().before('<input type="button" value="-" class="minus" />'), c.children().last().after('<input type="button" value="+" class="plus" />')
    })
}
String.prototype.getDecimals || (String.prototype.getDecimals = function() {
    var a = this,
        b = ("" + a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
    return b ? Math.max(0, (b[1] ? b[1].length : 0) - (b[2] ? +b[2] : 0)) : 0
}), jQuery(document).ready(function() {
    wcqib_refresh_quantity_increments()
}), jQuery(document).on("updated_wc_div", function() {
    wcqib_refresh_quantity_increments()
}), jQuery(document).on("click", ".plus, .minus", function() {
    var a = jQuery(this).closest(".quantity").find(".qty"),
        b = parseFloat(a.val()),
        c = parseFloat(a.attr("max")),
        d = parseFloat(a.attr("min")),
        e = a.attr("step");
    b && "" !== b && "NaN" !== b || (b = 0), "" !== c && "NaN" !== c || (c = ""), "" !== d && "NaN" !== d || (d = 0), "any" !== e && "" !== e && void 0 !== e && "NaN" !== parseFloat(e) || (e = 1), jQuery(this).is(".plus") ? c && b >= c ? a.val(c) : a.val((b + parseFloat(e)).toFixed(e.getDecimals())) : d && b <= d ? a.val(d) : b > 0 && a.val((b - parseFloat(e)).toFixed(e.getDecimals())), a.trigger("change")
});
</script>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-analytics.js";
     import { getDatabase, ref, set, child, update, remove, onValue ,get} from "https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js";
   import { getAuth, signInWithEmailAndPassword,createUserWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js'

  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyDCMUgTAgc2pLAphoaDun4MsoWZnYC958s",
    authDomain: "supllynvest.firebaseapp.com",
    projectId: "supllynvest",
    storageBucket: "supllynvest.appspot.com",
    messagingSenderId: "517382327295",
    appId: "1:517382327295:web:fd27323350cb0cffe135ca",
    measurementId: "G-KDK1PFR894"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const auth = getAuth(app);
  const db = getDatabase(app);


   var email = localStorage.getItem("email");
   var password =localStorage.getItem("password");
  signInWithEmailAndPassword(auth, email, password)
		.then((userCredential) => {
		  // Signed in 
		  const user = userCredential.user;
	      localStorage.setItem("email",email);
		  localStorage.setItem("password",password);
		 
    
      var starCountRef= ref(db, 'users/' + user.uid + '/supply');
onValue(starCountRef, (snapshot) => {
  const data = snapshot.val();
  var initial_money = data *3;
var after_money = initial_money + (30/100 *initial_money);
document.getElementById("mb").innerHTML = initial_money+ "$";
document.getElementById("ma").innerHTML = after_money+ "$";

  document.getElementById("spl").innerHTML = data + "SPL";
  document.getElementById("splb").innerHTML = data + "SPL";
  document.getElementById("spla").innerHTML = data + "SPL";

});

    
      
	     
		  // ...
		})
		.catch((error) => {
		  const errorCode = error.code;
		  const errorMessage = error.message;
		  document.getElementById('error').innerHTML=errorMessage;
		});


    var starCountRef= ref(db, 'days');
onValue(starCountRef, (snapshot) => {
  const data = snapshot.val();

  document.getElementById("days_until").innerHTML = "You can buy supplies for "+ data + " days from now.";

});





</script>
</body>
</html>